webpackJsonp([12],{js6L:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("mvHQ"),n=s.n(i),o=s("fZjL"),r=s.n(o),a={data:function(){return{emptyText:"loading...",role_id:null,role_name:null,defaultCheckedKeys:[],total:0,tableData:[],customProps:{children:"children",label:"show_name"},treeData:[],current:null,dialogFormVisible:!1,title:"添加子权限",form:{id:"",parent_id:"",name:"",show_name:""}}},computed:{types:function(){return this.$store.getters.activityTypes},currentRole:function(){return this.$store.getters.currentRole}},methods:{saveRolePermissions:function(){var e=this,t=this.$refs["role-permission-tree"].getCheckedNodes().filter(function(e){return 0==e.children.length}).map(function(e){return e.id}),s=this.currentRole.id;this.$http.post("/admin/privileges/give/permissions/to",{permissions:t,role_id:s}).then(function(t){e.$message({type:"success",message:"设置成功!"})}).catch(function(e){})},loadPermissionsTree:function(){var e=this;this.$http.get("/admin/privileges/permissions/tree").then(function(t){e.treeData=[t.data[r()(t.data)[0]]]})},loadRolePermissions:function(){var e=this,t=this.currentRole.id;this.$http.get("/admin/privileges/role/permissions",{params:{role_id:t}}).then(function(t){e.defaultCheckedKeys=t.data})},loadUserPermissions:function(){this.$http.get("/admin/privileges/user/permissions").then(function(e){console.log(":::>>>",n()(e)),localStorage.setItem("privileges",n()(e))})}},mounted:function(){this.loadRolePermissions(),this.loadPermissionsTree()}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"top-buttons",staticStyle:{display:"flex","flex-flow":"row nowrap"}},[s("router-link",{attrs:{to:"/privileges/roles",tag:"div"}},[s("span",{staticClass:"iconfont"},[e._v("")]),e._v("返回")]),e._v(" "),s("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),s("div",[e._v(e._s(e.role_name)+"权限")])],1),e._v(" "),s("div",[s("div",{staticStyle:{width:"60%"}},[s("el-tree",{ref:"role-permission-tree",attrs:{"empty-text":e.emptyText,data:e.treeData,"default-expand-all":"","show-checkbox":"","node-key":"id",props:e.customProps,"default-checked-keys":e.defaultCheckedKeys,"expand-on-click-node":!0,"check-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node;return t.data,s("span",{staticClass:"custom-tree-node"},[s("span",[e._v(e._s(i.label))])])}}])})],1),e._v(" "),s("div",{staticClass:"l-delimiter"}),e._v(" "),s("el-button",{on:{click:e.saveRolePermissions}},[e._v("保存")])],1)])},staticRenderFns:[]};var c=s("VU/8")(a,l,!1,function(e){s("kQ/a")},"data-v-19028be4",null);t.default=c.exports},"kQ/a":function(e,t){}});
//# sourceMappingURL=12.65e7463c60b4197d577f.js.map