webpackJsonp([7],{"+6Bu":function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a]);return n}},eZ6i:function(t,e){},rh17:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("+6Bu"),r=n.n(a),o=n("Gu7T"),s=n.n(o),c=n("Xxa5"),i=n.n(c),l=n("exGp"),u=n.n(l),d=n("Dd8w"),p=n.n(d),f=n("w+Hh"),h=n("Pgpu"),v=n.n(h),m=n("trTH"),_=n("FO7G"),w=n("M+9c"),C=n("TvJ3"),k=n("NYxO"),y=n("gyMJ"),b={data:function(){return{checkList:[],showSwitch:!1,contents:[],showForm:!1,formTitle:"添加文章",form:{keyword:""},ueditorConfig:m.a,channel_id:0,page:1,page_size:8,total:0}},components:{"channel-tree":f.a,VueUeditorWrap:v.a,imageUpload:_.a,multipleImageUpload:w.a,pager:C.a},computed:p()({},Object(k.b)(["parentChannel","currentChannel","currentModel"])),watch:{currentChannel:function(t,e){this.loadContents()},showForm:function(){this.$store.dispatch("collapse")},channel_id:function(t){var e=this;return u()(i.a.mark(function n(){var a,r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=9;break}return e.page=1,e.form.keyword="",n.next=5,y.a.getCmsChannelWhole({id:t});case 5:a=n.sent,r=a.data,e.$store.dispatch(e.$types.CMS_CURRENT_CHANNEL,r),e.$store.dispatch(e.$types.CMS_PARENT_CHANNEL,r);case 9:case"end":return n.stop()}},n,e)}))()}},methods:{search:function(){var t=this.form.keyword;this.loadContents({keyword:t})},goback:function(){this.showForm=!1},editContent:function(t){var e=this;return u()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.$router.push("/cms/content/edit?content_id="+t.id);case 1:case"end":return n.stop()}},n,e)}))()},deleteContent:function(t){var e=this;this.$confirm("确定删除文章?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y.a.deleteContent({id:t.id});case 2:return n.sent,e.$message({type:"success",message:"删除成功!"}),n.next=6,e.loadContents();case 6:case"end":return n.stop()}},n,e)})))},handleNodeClick:function(t){var e=this;return u()(i.a.mark(function n(){var a,r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(a=console).log.apply(a,s()(t)),e.showForm=!1,r=t[0],e.channel_id=r.id;case 4:case"end":return n.stop()}},n,e)}))()},addContent:function(){var t=this;return u()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$router.push("/cms/content/add?channel_id="+t.currentChannel.id);case 1:case"end":return e.stop()}},e,t)}))()},loadContents:function(t){var e=this,n=r()(t,[]);return u()(i.a.mark(function t(){var a,r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=p()({channel_id:e.channel_id,page:e.page,page_size:e.page_size},n),t.next=3,y.a.getChannelContents(a);case 3:r=t.sent,o=r.data,e.contents=o.contents,e.total=o.total;case 7:case"end":return t.stop()}},t,e)}))()},currentChange:function(t){var e=this;return u()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.page=t,e.loadContents();case 2:case"end":return n.stop()}},n,e)}))()}},created:function(){var t=this;return u()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("current meta:",t.$route.meta),t.channel_id=parseInt(t.$route.query.channel_id||0),e.next=4,t.loadContents();case 4:t.$store.dispatch("collapse");case 5:case"end":return e.stop()}},e,t)}))()}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"l-content-list"},[n("div",{directives:[{name:"title",rawName:"v-title",value:"内容管理",expression:"'内容管理'"}]}),t._v(" "),n("channel-tree",{attrs:{selectedKey:t.channel_id},on:{nodeClick:t.handleNodeClick}}),t._v(" "),n("div",{staticClass:"l-tree-content"},[t.showForm?t._e():n("div",{staticClass:"l-block"},[t.parentChannel?n("div",{staticClass:"l-block-header"},[n("div",[n("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "+t._s(t.parentChannel.hasOwnProperty("name")?t.parentChannel.name:"")+" "),n("span",{staticStyle:{color:"#fff"}},[t._v(t._s(t.parentChannel.id))]),t._v(" "),n("el-button",{attrs:{type:"default",size:"small"},on:{click:t.addContent}},[t._v("+新增")])],1)]):t._e(),t._v(" "),n("div",{staticClass:"l-block-body"},[n("div",{staticClass:"l-search-area",staticStyle:{"border-bottom":"1px solid #EBEEF5"}},[n("el-form",{ref:"form",attrs:{model:t.form,inline:!0}},[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{staticStyle:{width:"200px"},model:{value:t.form.keyword,callback:function(e){t.$set(t.form,"keyword",e)},expression:"form.keyword"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.search}},[t._v("搜索")])],1)],1)],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contents}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.link?n("a",{staticClass:"l-a-same",attrs:{href:e.row.link,target:"_blank"}},[t._v(t._s(e.row.title))]):n("span",[t._v(t._s(e.row.title))])]}}],null,!1,412524609)}),t._v(" "),n("el-table-column",{attrs:{prop:"channel.name",label:"栏目"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.editContent(e.row)}}},[t._v("编辑")]),t._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.deleteContent(e.row)}}},[t._v("删除")])]}}],null,!1,3534639574)})],1),t._v(" "),n("pager",{attrs:{total:t.total,"page-size":t.page_size},on:{"current-change":t.currentChange}})],1)])])],1)},staticRenderFns:[]};var x=n("VU/8")(b,g,!1,function(t){n("eZ6i")},"data-v-e3a998da",null);e.default=x.exports}});
//# sourceMappingURL=7.306f7fcb7636be86f254.js.map