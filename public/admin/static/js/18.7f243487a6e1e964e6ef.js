webpackJsonp([18],{"Kx+j":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("gRE1"),s=n.n(a),r=n("Xxa5"),o=n.n(r),i=n("exGp"),c=n.n(i),u=n("gyMJ"),d={data:function(){return{userId:null,month:null,user:null,value:new Date,attendances:{}}},computed:{},watch:{userId:function(e){var t=this;return c()(o.a.mark(function n(){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=3;break}return n.next=3,t.getUser(e);case 3:case"end":return n.stop()}},n,t)}))()},month:function(e){var t=this;return c()(o.a.mark(function n(){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.userId){n.next=3;break}return n.next=3,t.getUserAttendance(t.userId,e);case 3:case"end":return n.stop()}},n,t)}))()}},methods:{format0:function(){return""},format:function(e,t){return console.log(t),"dasdas"},getUser:function(e){var t=this;return c()(o.a.mark(function n(){var a,s;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.a.sniperDingGetUser({userId:e});case 2:a=n.sent,s=a.data,t.user=s;case 5:case"end":return n.stop()}},n,t)}))()},dateChange:function(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1;a<10&&(a="0"+a),this.month=n+"-"+a},showResult:function(e){return e.split("-").slice(0,2).join("-")==this.month},timeLine:function(e){var t=this.attendances[e]?this.attendances[e]:"",n=t.OnDuty,a=t.OffDuty,s=0,r=0;return n&&a&&(s=a.baseCheckTime-n.baseCheckTime,r=a.userCheckTime-n.userCheckTime),s&&r?r/s:0},readable:function(e){var t={"":"",Normal:"正常",Late:"迟到",Early:"早退",NotSigned:"未打卡</span>"},n="",a="",s="",r="",o="",i="",c="";if(this.attendances[e]&&this.attendances[e].OnDuty){n=this.attendances[e].OnDuty.timeResult;var u=this.attendances[e].OnDuty;(u.approveId||u.procInstId)&&(n="Normal"),(this.attendances[e].OnDuty.procInstId||this.attendances[e].OnDuty.approveId)&&(i='<span class="iconfont" title="已关联出差/请假/加班等">&#xe60b;</span>'),r=this.attendances[e].OnDuty.hi}if(this.attendances[e]&&this.attendances[e].OffDuty){a=this.attendances[e].OffDuty.timeResult;var d=this.attendances[e].OffDuty;(d.approveId||d.procInstId)&&(a="Normal"),(this.attendances[e].OffDuty.procInstId||this.attendances[e].OffDuty.approveId)&&(c='<span class="iconfont" title="已关联出差/请假/加班等">&#xe60b;</span>'),o=this.attendances[e].OffDuty.hi}if("Late"==n){var l=this.attendances[e].OnDuty;n='<span style="color: red;font-weight: 700">上班'+t[n]+Math.floor((l.userCheckTime-l.baseCheckTime)/1e3/60)+"分钟</span>"+i}else"NotSigned"==n?n='<span style="color: orange;font-weight: 700">上班'+t[n]+"</span>"+i:"Normal"==n&&(n='<span style="color: green;font-weight: 700">上班'+t[n]+"</span>"+i);if("Early"==a){var f=this.attendances[e].OffDuty;a='<span style="color: red;font-weight: 700">下班'+t[a]+Math.floor((f.baseCheckTime-f.userCheckTime)/1e3/60)+"分钟</span>"+c}else"NotSigned"==a?a='<span style="color: orange;font-weight: 700">下班'+t[a]+"</span>"+c:"Normal"==a&&(a='<span style="color: green;font-weight: 700">下班'+t[a]+"</span>"+c);if(this.attendances[e]&&this.attendances[e].leave){var p=this.attendances[e].leave;s='<span class="iconfont" title="请假">&#xe60b;</span><span>'+p.start_time.slice(5,-3)+"~"+p.end_time.slice(5,-3)+"</span>"}return{onDutyTimeResult:n,offDutyTimeResult:a,leaveResult:s,onDutyTime:r,offDutyTime:o}},getUserAttendance:function(e,t){var n=this;return c()(o.a.mark(function a(){var r,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.sniperDingGetUsersAttendance({userIds:[e],month:t});case 2:r=a.sent,i=r.data,console.log(s()(i)),n.attendances=s()(i)[0];case 6:case"end":return a.stop()}},a,n)}))()}},mounted:function(){var e=this;return c()(o.a.mark(function t(){var n,a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((n=e.$route.query.month||null)&&(e.month=n),!(a=e.$route.query.userId||null)){t.next=7;break}return e.userId=a,t.next=7,e.getUserAttendance(a,e.month);case 7:case"end":return t.stop()}},t,e)}))()}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-calendar",{on:{input:e.dateChange},scopedSlots:e._u([{key:"dateCell",fn:function(t){t.date;var a=t.data;return[n("p",{staticStyle:{"font-size":"18px","font-weight":"300"}},[e._v("\n                "+e._s(a.day.split("-").slice(1).join("/"))+"\n            ")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showResult(a.day)&&e.timeLine(a.day),expression:"showResult(data.day) && timeLine(data.day)"}]},[n("el-progress",{attrs:{percentage:50,"show-text":!1,"stroke-linecap":"square","stroke-width":4,color:"#ddd"}}),e._v(" "),n("el-progress",{staticStyle:{"margin-top":"2px"},attrs:{percentage:50*e.timeLine(a.day),"show-text":!1,"stroke-linecap":"square","stroke-width":4}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showResult(a.day),expression:"showResult(data.day)"}],staticStyle:{"font-size":"12px",color:"#5a5e66"}},[n("p",[n("span",{domProps:{innerHTML:e._s(e.readable(a.day).onDutyTimeResult)}}),n("span",[e._v(e._s(e.readable(a.day).onDutyTime))])]),e._v(" "),n("p",[n("span",{domProps:{innerHTML:e._s(e.readable(a.day).offDutyTimeResult)}}),n("span",[e._v(e._s(e.readable(a.day).offDutyTime))])]),e._v(" "),n("p",[n("span",{domProps:{innerHTML:e._s(e.readable(a.day).leaveResult)}})])])]}}])}),e._v(" "),n("div",[n("i",{staticStyle:{color:"#555"}},[e._v(e._s(e.month)+"月份")])]),e._v(" "),e.user?n("div",{staticStyle:{"border-top":"1px solid #ccc",display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},[n("div",[n("b",{staticStyle:{color:"#555"}},[e._v(e._s(e.user.name))]),n("i",{staticStyle:{color:"#aaa"}},[e._v("<"+e._s(e.user.orgEmail)+">")]),e._v(" "),n("span",{staticStyle:{color:"#fff"}},[e._v(e._s(e.user.userid))])]),e._v(" "),n("div",{staticStyle:{color:"#555","font-style":"italic"}},[e._v(e._s(e.user.department_info?e.user.department_info.name:""))])]):e._e()],1)},staticRenderFns:[]};var f=n("VU/8")(d,l,!1,function(e){n("y59k")},"data-v-5311e3f4",null);t.default=f.exports},y59k:function(e,t){}});
//# sourceMappingURL=18.7f243487a6e1e964e6ef.js.map