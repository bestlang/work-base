webpackJsonp([5],{"+6Bu":function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a]);return n}},rh17:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("+6Bu"),r=n.n(a),o=n("Xxa5"),s=n.n(o),c=n("exGp"),i=n.n(c),l=n("Dd8w"),u=n.n(l),d=n("w+Hh"),p=n("Pgpu"),h=n.n(p),f=n("trTH"),m=n("FO7G"),v=n("M+9c"),_=n("TvJ3"),w=n("NYxO"),C=n("gyMJ"),k={data:function(){return{checkList:[],showSwitch:!1,contents:[],showForm:!1,formTitle:"添加文章",form:{keyword:""},ueditorConfig:f.a,channel_id:0,page:1,page_size:8,total:0}},components:{"channel-tree":d.a,VueUeditorWrap:h.a,imageUpload:m.a,multipleImageUpload:v.a,pager:_.a},computed:u()({},Object(w.b)(["parentChannel","currentChannel","currentModel"])),watch:{currentChannel:function(t,e){this.loadContents()},showForm:function(){this.$store.dispatch("collapse")},channel_id:function(t){var e=this;return i()(s.a.mark(function n(){var a,r;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=9;break}return e.page=1,e.form.keyword="",n.next=5,C.a.getCmsChannelWhole({id:t});case 5:a=n.sent,r=a.data,e.$store.dispatch(e.$types.CMS_CURRENT_CHANNEL,r),e.$store.dispatch(e.$types.CMS_PARENT_CHANNEL,r);case 9:case"end":return n.stop()}},n,e)}))()}},methods:{search:function(){var t=this.form.keyword;this.loadContents({keyword:t})},goback:function(){this.showForm=!1},editContent:function(t){var e=this;return i()(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.$router.push("/cms/content/edit?content_id="+t.id);case 1:case"end":return n.stop()}},n,e)}))()},deleteContent:function(t){var e=this;this.$confirm("确定删除文章?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(i()(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,C.a.deleteContent({id:t.id});case 2:return n.sent,e.$message({type:"success",message:"删除成功!"}),n.next=6,e.loadContents();case 6:case"end":return n.stop()}},n,e)})))},handleNodeClick:function(t){var e=this;return i()(s.a.mark(function n(){var a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.showForm=!1,a=t[0],e.channel_id=a.id;case 3:case"end":return n.stop()}},n,e)}))()},addContent:function(){var t=this;return i()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$router.push("/cms/content/add?channel_id="+t.currentChannel.id);case 1:case"end":return e.stop()}},e,t)}))()},loadContents:function(t){var e=this,n=r()(t,[]);return i()(s.a.mark(function t(){var a,r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=u()({channel_id:e.channel_id,page:e.page,page_size:e.page_size},n),t.next=3,C.a.getChannelContents(a);case 3:r=t.sent,o=r.data,e.contents=o.contents,e.total=o.total;case 7:case"end":return t.stop()}},t,e)}))()},currentChange:function(t){var e=this;return i()(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.page=t,e.loadContents();case 2:case"end":return n.stop()}},n,e)}))()}},created:function(){var t=this;return i()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("current meta:",t.$route.meta),t.channel_id=parseInt(t.$route.query.channel_id||0),e.next=4,t.loadContents();case 4:t.$store.dispatch("collapse");case 5:case"end":return e.stop()}},e,t)}))()}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"l-content-list"},[n("div",{directives:[{name:"title",rawName:"v-title",value:"内容管理",expression:"'内容管理'"}]}),t._v(" "),n("channel-tree",{attrs:{selectedKey:t.channel_id},on:{nodeClick:t.handleNodeClick}}),t._v(" "),n("div",{staticClass:"l-tree-content"},[t.showForm?t._e():n("div",{staticClass:"l-block"},[t.parentChannel?n("div",{staticClass:"l-block-header"},[n("div",[n("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "+t._s(t.parentChannel.hasOwnProperty("name")?t.parentChannel.name:"")+" "),n("span",{staticStyle:{color:"white"}},[t._v(t._s(t.parentChannel.id))]),t._v(" "),n("el-button",{attrs:{type:"default",size:"small"},on:{click:t.addContent}},[t._v("+新增")])],1)]):t._e(),t._v(" "),n("div",{staticClass:"l-block-body"},[n("div",{staticClass:"l-search-area",staticStyle:{"border-bottom":"1px solid #EBEEF5"}},[n("el-form",{ref:"form",attrs:{model:t.form,inline:!0}},[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{staticStyle:{width:"200px"},model:{value:t.form.keyword,callback:function(e){t.$set(t.form,"keyword",e)},expression:"form.keyword"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.search}},[t._v("搜索")])],1)],1)],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contents}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"l-a-same",attrs:{href:e.row.link,target:"_blank"}},[t._v(t._s(e.row.title))])]}}],null,!1,1714693915)}),t._v(" "),n("el-table-column",{attrs:{prop:"channel.name",label:"栏目"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.editContent(e.row)}}},[t._v("编辑")]),t._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.deleteContent(e.row)}}},[t._v("删除")])]}}],null,!1,3534639574)})],1),t._v(" "),n("pager",{attrs:{total:t.total,"page-size":t.page_size},on:{"current-change":t.currentChange}})],1)])])],1)},staticRenderFns:[]};var b=n("VU/8")(k,y,!1,function(t){n("zW5h")},"data-v-f370444e",null);e.default=b.exports},zW5h:function(t,e){}});
//# sourceMappingURL=5.28ae29417af69f572106.js.map