webpackJsonp([28],{"J1+T":function(e,t){},js6L:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("mvHQ"),s=r.n(n),a=r("fZjL"),i=r.n(a),o=r("Xxa5"),c=r.n(o),l=r("exGp"),u=r.n(l),d=r("gyMJ"),p={data:function(){return{emptyText:"loading...",role_id:null,defaultCheckedKeys:[],total:0,tableData:[],customProps:{children:"children",label:"show_name"},treeData:[],currentRole:null,current:null,dialogFormVisible:!1,title:"添加子权限",form:{id:"",parent_id:"",name:"",show_name:""}}},computed:{types:function(){return this.$store.getters.activityTypes}},watch:{role_id:function(e){var t=this;return u()(c.a.mark(function r(){return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.loadRolePermissions(e);case 2:return r.next=4,t.getRole(e);case 4:case"end":return r.stop()}},r,t)}))()}},methods:{saveRolePermissions:function(){var e=this;return u()(c.a.mark(function t(){var r,n,s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$refs["role-permission-tree"].getCheckedNodes(),n=r.filter(function(e){return 0==e.children.length}).map(function(e){return e.id?e.id:""}),s=e.currentRole.id,t.next=5,d.a.givePermissionsTo({permissions:n,role_id:s});case 5:t.sent,e.$message({type:"success",message:"设置成功!"}),setTimeout(function(){location.reload()},1500);case 8:case"end":return t.stop()}},t,e)}))()},loadPermissionsTree:function(){var e=this;return u()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.getPermissionsTree();case 2:r=t.sent,e.treeData=[r.data[i()(r.data)[0]]];case 4:case"end":return t.stop()}},t,e)}))()},getRole:function(e){var t=this;return u()(c.a.mark(function r(){var n,s;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.a.getRole({role_id:e});case 2:n=r.sent,s=n.data,t.currentRole=s;case 5:case"end":return r.stop()}},r,t)}))()},loadRolePermissions:function(e){var t=this;return u()(c.a.mark(function r(){var n;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.a.getRolePermissions({role_id:e});case 2:n=r.sent,t.defaultCheckedKeys=n.data;case 4:case"end":return r.stop()}},r,t)}))()},loadUserPermissions:function(){var e=this;return u()(c.a.mark(function t(){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.getUserPermissions();case 2:r=e.sent,localStorage.setItem("privileges",s()(r));case 4:case"end":return e.stop()}},t,e)}))()}},mounted:function(){var e=this;return u()(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.role_id=parseInt(e.$route.query.role_id||0),t.next=3,e.loadPermissionsTree();case 3:case"end":return t.stop()}},t,e)}))()}},f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"l-block"},[r("div",{staticClass:"l-block-header"},[r("div",{staticStyle:{display:"inline-block"}},[r("router-link",{attrs:{to:"/privileges/roles",tag:"span"}},[r("span",{staticClass:"iconfont"},[e._v("")]),e._v("返回")]),e._v(" "),r("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),r("span",[e.currentRole?r("b",[e._v(e._s(e.currentRole.name))]):e._e(),e._v("权限")])],1),e._v(" "),r("div",[r("el-button",{attrs:{type:"primary"},on:{click:e.saveRolePermissions}},[e._v("保存")])],1)]),e._v(" "),r("div",{staticClass:"l-block-body"},[r("div",[r("div",{staticStyle:{width:"60%"}},[r("el-tree",{ref:"role-permission-tree",attrs:{"empty-text":e.emptyText,data:e.treeData,"default-expand-all":"","show-checkbox":"","node-key":"id",props:e.customProps,"default-checked-keys":e.defaultCheckedKeys,"expand-on-click-node":!1,"check-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return t.data,r("span",{staticClass:"custom-tree-node"},[r("span",{style:{letterSpacing:n.isLeaf?"0.2px":.2*Math.abs(n.level-10)+"px",fontSize:Math.max(22-2*n.level,13)+"px"}},[e._v(e._s(n.label))])])}}])})],1),e._v(" "),r("div",{staticClass:"l-delimiter"})])])])])},staticRenderFns:[]};var v=r("VU/8")(p,f,!1,function(e){r("J1+T")},"data-v-2b64ff6e",null);t.default=v.exports}});
//# sourceMappingURL=28.0237617317b0712085e7.js.map