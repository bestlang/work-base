{"version":3,"sources":["webpack:///src/pages/cms/content/edit.vue","webpack:///./src/pages/cms/content/edit.vue?2d10","webpack:///./src/pages/cms/content/edit.vue"],"names":["edit","data","checkList","showSwitch","contents","formTitle","form","positions","ueditorConfig","ueditor","contentPositions","channel_id","content_id","components","channel-tree","channelTree","VueUeditorWrap","vue_ueditor_wrap_min_default","a","imageUpload","multipleImageUpload","attachment","computed","extends_default","Object","vuex_esm","watch","val","_this","this","asyncToGenerator_default","regenerator_default","mark","_callee","_ref","wrap","_context","prev","next","loadWholeContent","api","getCmsChannelWhole","id","sent","$store","commit","$types","CMS_CURRENT_CHANNEL","loadContentPositions","currentChannel","stop","methods","goback","$router","push","_this2","_callee2","res","content","currentModel","contentFields","_context2","getWholeContent","model","fields","filter","item","is_channel","$set","forEach","field","length","value","metas","dispatch","CMS_CURRENT_MODEL","saveContent","_this3","_callee3","_context3","model_id","success","$message","type","message","handleNodeClick","node","_this4","_callee4","channel","_context4","CMS_PARENT_CHANNEL","loadModel","_this5","_callee5","idx","_context5","getModel","_this6","arguments","undefined","_callee6","_context6","abrupt","getContentPositions","mounted","_this7","_callee7","_context7","parseInt","$route","query","content_edit","render","_vm","_h","$createElement","_c","_self","staticClass","directives","name","rawName","expression","_v","on","click","attrs","direction","staticStyle","font-weight","_s","_e","label-width","_l","index","label","key","callback","$$v","Array","isArray","option","config","size","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/5.452ca7c6b4213429931f.js","sourcesContent":["<style lang=\"less\" scoped>\n    .l-content-list{\n        display: flex;\n        flex-flow: row nowrap;\n        min-height: calc(100vh - 50px - 20px);\n        margin:-20px 0 -20px -20px;\n        overflow-x: hidden;\n        .l-tree-content{\n            padding: 20px;\n            flex-grow: 1;\n            display: flex;\n            flex-flow: row nowrap;\n            box-sizing: border-box;\n            width: calc(100% - 240px);\n        }\n    }\n</style>\n<template>\n    <div class=\"l-content-list\">\n        <div v-title=\"'内容管理'\"></div>\n        <!--<channel-tree @nodeClick=\"handleNodeClick\" :title=\"'栏目选择'\" :selectedKey=\"channel_id\"></channel-tree>-->\n        <div class=\"l-tree-content\">\n            <div class=\"l-block\" v-if=\"currentModel\">\n                <div class=\"l-block-header\">\n                    <div>\n                        <span class=\"l-go-back\" @click=\"goback\"><span class=\"iconfont\">&#xe601;</span>返回</span>\n                        <el-divider direction=\"vertical\"></el-divider>\n                        <!--<i class=\"iconfont\">&#xe64c;</i>「」-->\n                        <span v-if=\"currentChannel\">在<span style=\"font-weight: 700\">“{{currentChannel.name}}”</span>下{{formTitle}}</span>\n                    </div>\n                </div>\n                <div class=\"l-block-body\">\n                    <el-form label-width=\"100px\">\n                        <template v-for=\"(item, index) in currentModel.fields\">\n\n                            <el-form-item v-if=\"item.type=='text'\" :label=\"item.label\">\n                                <el-input :key=\"index\" :name=\"item.field\" v-model=\"form[item.field]\"></el-input>\n                            </el-form-item>\n\n                            <el-form-item v-if=\"item.type=='checkbox' && Array.isArray(form[item.field])\" :label=\"item.label\">\n                                <el-checkbox-group v-model=\"form[item.field]\">\n                                    <el-checkbox :label=\"option.value\" v-for=\"option in item.extra\">{{option.name}}</el-checkbox>\n                                </el-checkbox-group>\n                            </el-form-item>\n\n                            <el-form-item v-if=\"item.type=='image'\" :label=\"item.label\">\n                                <image-upload v-model=\"form[item.field]\"></image-upload>\n                            </el-form-item>\n\n                            <el-form-item v-if=\"item.type=='multiple-image' && form[item.field]\" :label=\"item.label\">\n                                <multiple-image-upload v-model=\"form[item.field]\"></multiple-image-upload>\n                            </el-form-item>\n\n                            <el-form-item v-if=\"item.type=='attachment' && form[item.field]\" class=\"l-mb-22\" :label=\"item.label\">\n                                <div>\n                                    <attachment v-model=\"form[item.field]\"></attachment>\n                                </div>\n                            </el-form-item>\n\n                            <el-form-item v-if=\"item.type=='textarea'\" :label=\"item.label\">\n                                <el-input type=\"textarea\" v-model=\"form[item.field]\"></el-input>\n                            </el-form-item>\n\n                            <el-form-item v-if=\"item.type=='content'\" class=\"l-mb-22\" :label=\"item.label\">\n                                <div>\n                                    <vue-ueditor-wrap v-model=\"form[item.field]\" :config=\"ueditorConfig\"></vue-ueditor-wrap>\n                                </div>\n                            </el-form-item>\n\n                        </template>\n                        <el-form-item label=\"编辑推荐位\" v-if=\"contentPositions && contentPositions.length\">\n                            <el-checkbox-group  v-model=\"form['positions']\">\n                                <el-checkbox :label=\"option.id\" v-for=\"option in contentPositions\">{{option.name}}</el-checkbox>\n                            </el-checkbox-group>\n                        </el-form-item>\n                        <el-form-item>\n                            <el-button type=\"primary\" size=\"small\" @click=\"saveContent\">提交</el-button>\n                        </el-form-item>\n                    </el-form>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\n    import channelTree from \"../components/channelTree\";\n    import VueUeditorWrap from 'vue-ueditor-wrap';\n    import ueditorConfig from \"../../../store/ueditor\";\n    import imageUpload from \"@/components/imageUpload\"\n    import multipleImageUpload from \"@/components/multipleImageUpload\"\n    import attachment from \"@/components/attachment\"\n    import {mapGetters} from 'vuex'\n    import api from '../../../api/index'\n\n    export default {\n        data() {\n            return {\n                checkList:[],\n                showSwitch: false,\n                contents: [],\n                formTitle: '编辑内容',\n                form:{\n                    positions:[]\n                },\n                ueditorConfig: ueditorConfig,\n                contentPositions: [],\n                channel_id: 0,\n                content_id: 0\n            }\n        },\n        components:{\n            'channel-tree': channelTree,\n            VueUeditorWrap,\n            imageUpload,\n            multipleImageUpload,\n            attachment\n        },\n        computed:{\n            ...mapGetters([\n                'parentChannel',\n                'currentChannel',\n                'currentModel',\n            ]),\n        },\n        watch:{\n            async content_id(val){\n                if(val){\n                    await this.loadWholeContent(val)\n                    let {data} = await api.getCmsChannelWhole({id: this.channel_id})\n                    this.$store.commit(this.$types.CMS_CURRENT_CHANNEL, data)\n                    await this.loadContentPositions(this.currentChannel.id);\n                }\n            }\n        },\n        methods: {\n            goback(){\n                this.$router.push('/cms/content?channel_id='+this.currentChannel.id)\n            },\n            async loadWholeContent(id){\n                let res = await api.getWholeContent({id});\n\n                let content = res.data;\n                this.channel_id = content.channel_id;\n                let currentModel = res.data.model;\n                currentModel.fields = currentModel.fields.filter(item => { return !item.is_channel })\n\n                let contentFields = ['channel_id', 'model_id', 'title', 'keywords', 'description'];\n\n                this.$set(this.form, 'id', id);\n\n                contentFields.forEach( field => {this.$set(this.form, field, content[field])} );\n\n                if(content.contents && content.contents.length){\n                    content.contents.forEach( item => {this.$set(this.form, item.field, item.value)} );\n                }\n\n                if(content.metas && content.metas.length){\n                    content.metas.forEach(\n                        item => {\n                            this.$set(this.form, item.field, item.value);\n                        });\n                }\n\n                if(content.positions){\n                    this.$set(this.form, 'positions', content.positions)\n                }\n\n                this.$store.dispatch(this.$types.CMS_CURRENT_MODEL, currentModel)\n            },\n            async saveContent(){\n                if(!this.form.channel_id && !this.form.model_id){\n                    this.$set(this.form, 'model_id', this.currentModel.id);\n                    this.$set(this.form, 'channel_id', this.currentChannel.id)\n                }\n                let res = await api.saveContent(this.form)\n                if(res.success){\n                    this.$message({\n                        type: 'success',\n                        message: '添加成功!'\n                    });\n                    this.goback()\n                }\n            },\n\n            async handleNodeClick(node, ...params){\n                let channel = node[0]\n                this.channel_id = channel.id\n                this.$store.dispatch(this.$types.CMS_CURRENT_CHANNEL, channel);\n                this.$store.dispatch(this.$types.CMS_PARENT_CHANNEL, channel);\n                await this.loadModel(channel.model.id)\n                await this.loadContentPositions()\n            },\n            async loadModel(id){\n                let res = await api.getModel({id})\n                let currentModel = res.data;\n                // 过滤掉模型中属于栏目的字段\n                currentModel.fields = currentModel.fields.filter(item => { return !item.is_channel })\n                this.$store.dispatch(this.$types.CMS_CURRENT_MODEL, currentModel)\n                for(let idx in this.currentModel.fields){\n                    let item = this.currentModel.fields[idx];\n                    // 重置表单\n                    this.$set(this.form, item.field, '');\n                    if(item.type == 'checkbox' || item.type == 'multiple-image'){\n                        this.$set(this.form, item.field, []);\n                    }\n                }\n                this.$set(this.form, 'positions', [])\n            },\n            async loadContentPositions(channel_id=0){\n                if(!channel_id){\n                    if(this.currentChannel && this.currentChannel.id){\n                        channel_id = this.currentChannel.id;\n                    }\n                }\n                // 没有选定的栏目, 不进行[可选推荐位]的加载\n                if(!channel_id){\n                    return;\n                }\n                let res = await api.getContentPositions({channel_id})\n                this.contentPositions = res.data\n            }\n        },\n        async mounted() {\n            this.content_id = parseInt(this.$route.query.content_id || 0);\n            this.$store.dispatch('toggleState');\n        }\n    }\n</script>\n\n\n// WEBPACK FOOTER //\n// src/pages/cms/content/edit.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"l-content-list\"},[_c('div',{directives:[{name:\"title\",rawName:\"v-title\",value:('内容管理'),expression:\"'内容管理'\"}]}),_vm._v(\" \"),_c('div',{staticClass:\"l-tree-content\"},[(_vm.currentModel)?_c('div',{staticClass:\"l-block\"},[_c('div',{staticClass:\"l-block-header\"},[_c('div',[_c('span',{staticClass:\"l-go-back\",on:{\"click\":_vm.goback}},[_c('span',{staticClass:\"iconfont\"},[_vm._v(\"\")]),_vm._v(\"返回\")]),_vm._v(\" \"),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_vm._v(\" \"),(_vm.currentChannel)?_c('span',[_vm._v(\"在\"),_c('span',{staticStyle:{\"font-weight\":\"700\"}},[_vm._v(\"“\"+_vm._s(_vm.currentChannel.name)+\"”\")]),_vm._v(\"下\"+_vm._s(_vm.formTitle))]):_vm._e()],1)]),_vm._v(\" \"),_c('div',{staticClass:\"l-block-body\"},[_c('el-form',{attrs:{\"label-width\":\"100px\"}},[_vm._l((_vm.currentModel.fields),function(item,index){return [(item.type=='text')?_c('el-form-item',{attrs:{\"label\":item.label}},[_c('el-input',{key:index,attrs:{\"name\":item.field},model:{value:(_vm.form[item.field]),callback:function ($$v) {_vm.$set(_vm.form, item.field, $$v)},expression:\"form[item.field]\"}})],1):_vm._e(),_vm._v(\" \"),(item.type=='checkbox' && Array.isArray(_vm.form[item.field]))?_c('el-form-item',{attrs:{\"label\":item.label}},[_c('el-checkbox-group',{model:{value:(_vm.form[item.field]),callback:function ($$v) {_vm.$set(_vm.form, item.field, $$v)},expression:\"form[item.field]\"}},_vm._l((item.extra),function(option){return _c('el-checkbox',{attrs:{\"label\":option.value}},[_vm._v(_vm._s(option.name))])}),1)],1):_vm._e(),_vm._v(\" \"),(item.type=='image')?_c('el-form-item',{attrs:{\"label\":item.label}},[_c('image-upload',{model:{value:(_vm.form[item.field]),callback:function ($$v) {_vm.$set(_vm.form, item.field, $$v)},expression:\"form[item.field]\"}})],1):_vm._e(),_vm._v(\" \"),(item.type=='multiple-image' && _vm.form[item.field])?_c('el-form-item',{attrs:{\"label\":item.label}},[_c('multiple-image-upload',{model:{value:(_vm.form[item.field]),callback:function ($$v) {_vm.$set(_vm.form, item.field, $$v)},expression:\"form[item.field]\"}})],1):_vm._e(),_vm._v(\" \"),(item.type=='attachment' && _vm.form[item.field])?_c('el-form-item',{staticClass:\"l-mb-22\",attrs:{\"label\":item.label}},[_c('div',[_c('attachment',{model:{value:(_vm.form[item.field]),callback:function ($$v) {_vm.$set(_vm.form, item.field, $$v)},expression:\"form[item.field]\"}})],1)]):_vm._e(),_vm._v(\" \"),(item.type=='textarea')?_c('el-form-item',{attrs:{\"label\":item.label}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.form[item.field]),callback:function ($$v) {_vm.$set(_vm.form, item.field, $$v)},expression:\"form[item.field]\"}})],1):_vm._e(),_vm._v(\" \"),(item.type=='content')?_c('el-form-item',{staticClass:\"l-mb-22\",attrs:{\"label\":item.label}},[_c('div',[_c('vue-ueditor-wrap',{attrs:{\"config\":_vm.ueditorConfig},model:{value:(_vm.form[item.field]),callback:function ($$v) {_vm.$set(_vm.form, item.field, $$v)},expression:\"form[item.field]\"}})],1)]):_vm._e()]}),_vm._v(\" \"),(_vm.contentPositions && _vm.contentPositions.length)?_c('el-form-item',{attrs:{\"label\":\"编辑推荐位\"}},[_c('el-checkbox-group',{model:{value:(_vm.form['positions']),callback:function ($$v) {_vm.$set(_vm.form, 'positions', $$v)},expression:\"form['positions']\"}},_vm._l((_vm.contentPositions),function(option){return _c('el-checkbox',{attrs:{\"label\":option.id}},[_vm._v(_vm._s(option.name))])}),1)],1):_vm._e(),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.saveContent}},[_vm._v(\"提交\")])],1)],2)],1)]):_vm._e()])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-d5d1a974\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/cms/content/edit.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-d5d1a974\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./edit.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./edit.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./edit.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-d5d1a974\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./edit.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-d5d1a974\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/cms/content/edit.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}